<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Collagen Types — Interactive Table</title>
<style>
  :root { --radius: 14px; --gap: 12px; }
  body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background: #f6f7fb; color: #0f172a; }
  .wrap { max-width: 1100px; margin: 40px auto; padding: 0 16px; }
  .card { background: #fff; border-radius: 18px; box-shadow: 0 10px 30px rgba(2,6,23,.06); border: 1px solid #e5e7eb; }
  .card-header { padding: 22px 22px 10px 22px; border-bottom: 1px solid #f1f5f9; }
  .card-title { font-size: clamp(22px, 2.2vw, 28px); font-weight: 650; letter-spacing: -0.02em; }
  .card-content { padding: 18px 22px 22px 22px; }
  .controls { display: grid; grid-template-columns: 1fr 220px 220px; gap: var(--gap); align-items: end; margin-bottom: 10px; }
  .label { display:block; font-size: 12px; color: #475569; margin-bottom: 6px; }
  .input, .select { width: 100%; padding: 10px 12px; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 14px; background: #fff; outline: none; }
  .input:focus, .select:focus { border-color: #94a3b8; box-shadow: 0 0 0 4px #e2e8f030; }
  .legend { display:flex; flex-wrap: wrap; gap: 8px; margin: 6px 0 12px; }
  .chip { display:inline-flex; align-items:center; gap:6px; padding: 4px 8px; border-radius: 999px; border: 1px solid; font-size: 12px; }
  .chip.blue { background:#dbeafe; color:#1d4ed8; border-color:#bfdbfe; }
  .chip.green { background:#d1fae5; color:#047857; border-color:#a7f3d0; }
  .chip.amber { background:#fef3c7; color:#92400e; border-color:#fde68a; }
  .chip.pink { background:#fce7f3; color:#be185d; border-color:#fbcfe8; }
  .chip.purple { background:#ede9fe; color:#6d28d9; border-color:#ddd6fe; }
  .chip.rose { background:#ffe4e6; color:#be123c; border-color:#fecdd3; }
  .chip.cyan { background:#cffafe; color:#0e7490; border-color:#a5f3fc; }
  .chip.lime { background:#ecfccb; color:#3f6212; border-color:#d9f99d; }
  .chip.gray { background:#f1f5f9; color:#334155; border-color:#e2e8f0; }
  .table-wrap { overflow:auto; border:1px solid #e2e8f0; border-radius: 16px; background: #fff; }
  table { width: 100%; border-collapse: collapse; font-size: 14px; }
  thead { position: sticky; top: 0; background: #f8fafc; z-index: 1; }
  th, td { text-align: left; padding: 12px 14px; vertical-align: top; }
  th { font-weight: 600; color: #0f172a; }
  tbody tr:nth-child(2n) { background: #f8fafc; }
  .footer { display:flex; justify-content: space-between; align-items:center; margin-top:12px; }
  .muted { color:#64748b; font-size:12px; }
  .btn { appearance:none; border:1px solid #e2e8f0; background:#fff; padding:10px 12px; border-radius: 12px; font-size: 14px; cursor:pointer; display:inline-flex; align-items:center; gap:8px; }
  .btn:hover { background:#f8fafc; }
  .badge { display:inline-flex; align-items:center; padding:3px 8px; border-radius:999px; font-size:12px; border:1px solid rgba(0,0,0,.06); }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="card-header">
        <div class="card-title">Collagen Types</div>
      </div>
      <div class="card-content">
        <div class="controls">
          <div>
            <label class="label" for="q">Search</label>
            <input id="q" class="input" type="search" placeholder="Gene, tissue, disease, type…">
          </div>
          <div>
            <label class="label" for="cls">Filter by class</label>
            <select id="cls" class="select">
              <option value="all">All classes</option>
            </select>
          </div>
          <div>
            <label class="label" for="sort">Sort</label>
            <select id="sort" class="select">
              <option value="type-asc">Type (I → XXIX)</option>
              <option value="type-desc">Type (XXIX → I)</option>
              <option value="gene-asc">Gene (A → Z)</option>
              <option value="gene-desc">Gene (Z → A)</option>
            </select>
          </div>
        </div>

        <div class="legend" id="legend"></div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th style="width:120px">Type</th>
                <th style="width:150px">Class</th>
                <th>Gene(s)</th>
                <th>Tissue expression (main)</th>
                <th>Known mutations / disease associations</th>
              </tr>
            </thead>
            <tbody id="rows"></tbody>
          </table>
        </div>

        <div class="footer">
          <div class="muted" id="count"></div>
          <button class="btn" id="export">Export CSV</button>
        </div>
      </div>
    </div>
  </div>

<script>
const DATA = [
  { genes: "COL1A1, COL1A2", tissues: "Bone, skin, tendon, organs, interstitial matrix", diseases: "Osteogenesis imperfecta; Ehlers-Danlos; cancer", type: "Type I", cls: "Fibrillar" },
  { genes: "COL2A1", tissues: "Cartilage, vitreous body", diseases: "Chondrodysplasias; Stickler syndrome", type: "Type II", cls: "Fibrillar" },
  { genes: "COL3A1", tissues: "Skin, blood vessels, hollow organs", diseases: "Vascular Ehlers-Danlos syndrome", type: "Type III", cls: "Fibrillar" },
  { genes: "COL4A1–COL4A6", tissues: "Basement membranes (kidney, eye, ear, vessels)", diseases: "Alport syndrome; HANAC syndrome", type: "Type IV", cls: "Network-forming" },
  { genes: "COL5A1, COL5A2", tissues: "Skin, bone, cornea, placenta, hair", diseases: "Classical Ehlers-Danlos syndrome", type: "Type V", cls: "Fibrillar" },
  { genes: "COL6A1, COL6A2, COL6A3", tissues: "Ubiquitous ECM, muscle, connective tissue", diseases: "Ullrich congenital muscular dystrophy; Bethlem myopathy", type: "Type VI", cls: "Microfibrillar" },
  { genes: "COL7A1", tissues: "Skin, mucous membranes", diseases: "Dystrophic epidermolysis bullosa", type: "Type VII", cls: "Anchoring fibril" },
  { genes: "COL8A1, COL8A2", tissues: "Cornea, vessels, heart, skin, kidney, bone", diseases: "Corneal dystrophies", type: "Type VIII", cls: "Short chain" },
  { genes: "COL9A1, COL9A2, COL9A3", tissues: "Cartilage, vitreous body, cornea", diseases: "Multiple epiphyseal dysplasia", type: "Type IX", cls: "FACIT" },
  { genes: "COL10A1", tissues: "Cartilage (growth plate)", diseases: "Schmid metaphyseal chondrodysplasia", type: "Type X", cls: "Short chain" },
  { genes: "COL11A1, COL11A2", tissues: "Cartilage, intervertebral disc", diseases: "Stickler syndrome; Marshall syndrome; cancer", type: "Type XI", cls: "Fibrillar" },
  { genes: "COL12A1", tissues: "Tendons, ligaments, periosteum, skin, bone, cornea", diseases: "Myopathic Ehlers-Danlos syndrome", type: "Type XII", cls: "FACIT" },
  { genes: "COL13A1", tissues: "Skin, endothelial cells, heart, eye, muscle", diseases: "Neuromuscular junction defects", type: "Type XIII", cls: "Transmembrane" },
  { genes: "COL14A1", tissues: "Bone marrow, skin, tendon, eye, nerves, vessels", diseases: "Not well defined", type: "Type XIV", cls: "FACIT" },
  { genes: "COL15A1", tissues: "Placenta, kidney, testis, skin, heart, vessels", diseases: "Not well defined", type: "Type XV", cls: "Multiplexin" },
  { genes: "COL16A1", tissues: "Kidney, muscle, heart, skin", diseases: "Not well defined", type: "Type XVI", cls: "FACIT" },
  { genes: "COL17A1", tissues: "Skin (hemidesmosomes)", diseases: "Junctional epidermolysis bullosa", type: "Type XVII", cls: "Transmembrane" },
  { genes: "COL18A1", tissues: "Basement membranes (eye, liver, kidney, lung)", diseases: "Knobloch syndrome", type: "Type XVIII", cls: "Multiplexin" },
  { genes: "COL20A1", tissues: "Neural tissues", diseases: "Not well defined", type: "Type XX", cls: "" },
  { genes: "COL21A1", tissues: "Vessels, muscle, placenta, kidney, heart, stomach", diseases: "Not well defined", type: "Type XXI", cls: "" },
  { genes: "COL22A1", tissues: "Tissue junctions", diseases: "Not well defined", type: "Type XXII", cls: "" },
  { genes: "COL23A1", tissues: "Metastatic cancer cells", diseases: "Not well defined", type: "Type XXIII", cls: "" },
  { genes: "COL24A1", tissues: "Cornea, bone", diseases: "Not well defined", type: "Type XXIV", cls: "" },
  { genes: "COL25A1", tissues: "Brain, heart, testis, eye", diseases: "Not well defined", type: "Type XXV", cls: "" },
  { genes: "COL26A1", tissues: "Testis, ovary", diseases: "Not well defined", type: "Type XXVI", cls: "" },
  { genes: "COL27A1", tissues: "Cartilage, eye", diseases: "Steel syndrome", type: "Type XXVII", cls: "" },
  { genes: "COL28A1", tissues: "Skin, vessels, bone, cornea", diseases: "Not well defined", type: "Type XXVIII", cls: "" },
  { genes: "COL29A1", tissues: "Skin", diseases: "Not well defined", type: "Type XXIX", cls: "" },
];

const CLASS_COLORS = {
  "Fibrillar": "blue",
  "Network-forming": "green",
  "FACIT": "amber",
  "Short chain": "pink",
  "Microfibrillar": "purple",
  "Anchoring fibril": "rose",
  "Transmembrane": "cyan",
  "Multiplexin": "lime",
  "": "gray",
};

const romanMap = {"I":1,"II":2,"III":3,"IV":4,"V":5,"VI":6,"VII":7,"VIII":8,"IX":9,"X":10,"XI":11,"XII":12,"XIII":13,"XIV":14,"XV":15,"XVI":16,"XVII":17,"XVIII":18,"XIX":19,"XX":20,"XXI":21,"XXII":22,"XXIII":23,"XXIV":24,"XXV":25,"XXVI":26,"XXVII":27,"XXVIII":28,"XXIX":29};

function typeIndex(t){ return romanMap[(t||'').replace(/Type\\s+/i,'').trim()] || 999; }

function render(){
  const q = document.getElementById('q').value.toLowerCase();
  const cls = document.getElementById('cls').value;
  const sort = document.getElementById('sort').value;

  let rows = DATA.filter(d => (d.genes + ' ' + d.tissues + ' ' + d.diseases + ' ' + d.type + ' ' + d.cls).toLowerCase().includes(q));
  if (cls !== 'all'){
    if (cls === '(none)') rows = rows.filter(r => !r.cls);
    else rows = rows.filter(r => r.cls === cls);
  }

  if (sort === 'type-asc') rows.sort((a,b)=> typeIndex(a.type)-typeIndex(b.type));
  if (sort === 'type-desc') rows.sort((a,b)=> typeIndex(b.type)-typeIndex(a.type));
  if (sort === 'gene-asc') rows.sort((a,b)=> a.genes.localeCompare(b.genes));
  if (sort === 'gene-desc') rows.sort((a,b)=> b.genes.localeCompare(a.genes));

  const tbody = document.getElementById('rows');
  tbody.innerHTML = rows.map((r,i)=>`
    <tr${i%2? '': ''}>
      <td><strong>${r.type}</strong></td>
      <td><span class="badge chip ${CLASS_COLORS[r.cls] || 'gray'}">${r.cls || '—'}</span></td>
      <td>${r.genes}</td>
      <td>${r.tissues}</td>
      <td>${r.diseases}</td>
    </tr>`).join('');

  document.getElementById('count').textContent = `${rows.length} ${rows.length===1?'record':'records'} shown`;
}

function init(){
  // Fill class filter
  const clsSel = document.getElementById('cls');
  const uniq = Array.from(new Set(DATA.map(d=>d.cls).filter(Boolean)));
  uniq.forEach(c => {
    const opt = document.createElement('option');
    opt.value = c; opt.textContent = c; clsSel.appendChild(opt);
  });
  const noneOpt = document.createElement('option');
  noneOpt.value='(none)'; noneOpt.textContent='(none)';
  clsSel.appendChild(noneOpt);

  // Legend
  const legend = document.getElementById('legend');
  Object.keys(CLASS_COLORS).forEach(k=>{
    if (k==='')
      return;
    const span = document.createElement('span');
    span.className = `chip ${CLASS_COLORS[k]}`;
    span.textContent = k;
    legend.appendChild(span);
  });
  const span = document.createElement('span');
  span.className = 'chip gray';
  span.textContent = '— (no class specified)';
  legend.appendChild(span);

  document.getElementById('q').addEventListener('input', render);
  clsSel.addEventListener('change', render);
  document.getElementById('sort').addEventListener('change', render);
  document.getElementById('export').addEventListener('click', exportCSV);
  render();
}

function exportCSV(){
  const q = document.getElementById('q').value.toLowerCase();
  const cls = document.getElementById('cls').value;
  const sort = document.getElementById('sort').value;
  let rows = DATA.filter(d => (d.genes + ' ' + d.tissues + ' ' + d.diseases + ' ' + d.type + ' ' + d.cls).toLowerCase().includes(q));
  if (cls !== 'all'){
    if (cls === '(none)') rows = rows.filter(r => !r.cls);
    else rows = rows.filter(r => r.cls === cls);
  }
  if (sort === 'type-asc') rows.sort((a,b)=> typeIndex(a.type)-typeIndex(b.type));
  if (sort === 'type-desc') rows.sort((a,b)=> typeIndex(b.type)-typeIndex(a.type));
  if (sort === 'gene-asc') rows.sort((a,b)=> a.genes.localeCompare(b.genes));
  if (sort === 'gene-desc') rows.sort((a,b)=> b.genes.localeCompare(a.genes));

  const headers = ['Type','Class','Gene(s)','Tissue Expression (Main)','Known Mutations / Disease Associations'];
  const lines = [headers.join(',')];
  rows.forEach(r=>{
    const row = [r.type, r.cls || '', r.genes, r.tissues, r.diseases].map(x=> `"${String(x).replaceAll('"','""')}"`).join(',');
    lines.push(row);
  });
  const blob = new Blob(["\ufeff"+lines.join("\n")], {type: "text/csv;charset=utf-8;"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'collagens_table.csv'; a.click();
  URL.revokeObjectURL(url);
}

window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
